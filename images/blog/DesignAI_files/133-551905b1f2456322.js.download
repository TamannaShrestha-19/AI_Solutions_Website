(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{124:(e,a,n)=>{"use strict";n.d(a,{C:()=>d});var i=n(51298),t=n(48149),r=n(62748),l=n.n(r),o=n(10862),s=n.n(o);function d(e,a){return(0,i.v)(l(),{...a,update(a,{data:n}){let i=n?.companyFollowerCreate;i&&(a.writeQuery({query:s(),data:{companyFollower:i},variables:{user_idx:i.idx}}),(0,t.Rc)(a,e,e=>({...e,follower_count:e.follower_count+1})))}})}},55193:(e,a,n)=>{"use strict";n.d(a,{$:()=>l,v:()=>r});var i=n(55922),t=n(18893);function r(e,a){let[n,t]=(0,i.AW)(e,e=>!!e.is_private),r=[...n,...t];return"number"==typeof a&&r.length>a&&(r.length=a),r}function l(e){return 0===e?1/0:"number"==typeof e?e:t.y7}},62748:(e,a,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateCompanyFollower"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"avatar"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"companyFollowerCreate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}},{kind:"Argument",name:{kind:"Name",value:"avatar"},value:{kind:"Variable",name:{kind:"Name",value:"avatar"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CompanyFollower"},directives:[]}]}}]}}],loc:{start:0,end:230}};i.loc.source={body:"#import './fragments/company-follower.graphql'\n\nmutation CreateCompanyFollower($name: String!, $email: String, $avatar: String) {\n  companyFollowerCreate(name: $name, email: $email, avatar: $avatar) {\n    ...CompanyFollower\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};i.definitions=i.definitions.concat(n(21501).definitions.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var a=e.name.value;return!t[a]&&(t[a]=!0,!0)}));var r={};function l(e,a){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==a)return i}}i.definitions.forEach(function(e){if(e.name){var a=new Set;!function e(a,n){if("FragmentSpread"===a.kind)n.add(a.name.value);else if("VariableDefinition"===a.kind){var i=a.type;"NamedType"===i.kind&&n.add(i.name.value)}a.selectionSet&&a.selectionSet.selections.forEach(function(a){e(a,n)}),a.variableDefinitions&&a.variableDefinitions.forEach(function(a){e(a,n)}),a.definitions&&a.definitions.forEach(function(a){e(a,n)})}(e,a),r[e.name.value]=a}}),e.exports=i,e.exports.CreateCompanyFollower=function(e,a){var n={kind:e.kind,definitions:[l(e,a)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=r[a]||new Set,t=new Set,o=new Set;for(i.forEach(function(e){o.add(e)});o.size>0;){var s=o;o=new Set,s.forEach(function(e){t.has(e)||(t.add(e),(r[e]||new Set).forEach(function(e){o.add(e)}))})}return t.forEach(function(a){var i=l(e,a);i&&n.definitions.push(i)}),n}(i,"CreateCompanyFollower")},67375:(e,a,n)=>{"use strict";n.d(a,{A:()=>t});var i=n(6029);n(55729);let t=(0,n(99966).w)((0,i.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{clipRule:"evenodd",d:"m5.32141 11.9999c0-3.68851 2.9901-6.67861 6.67859-6.67861 3.6885 0 6.6786 2.9901 6.6786 6.67861 0 3.6884-2.9901 6.6785-6.6786 6.6785-3.68849 0-6.67859-2.9901-6.67859-6.6785zm6.67859-8.17861c-4.51692 0-8.17859 3.66167-8.17859 8.17861 0 4.5169 3.66167 8.1785 8.17859 8.1785 4.5169 0 8.1786-3.6616 8.1786-8.1785 0-4.51694-3.6617-8.17861-8.1786-8.17861zm-.125 4.67871c.6213 0 1.125-.50368 1.125-1.125s-.5037-1.125-1.125-1.125-1.125.50368-1.125 1.125.5037 1.125 1.125 1.125zm-1.2427 2.5981c0-.4142.3358-.75.75-.75.4226 0 .8278.1679 1.1265.4667.2988.2987.4667.7039.4667 1.1265v4.2156c0 .0247.0098.0484.0272.0658.0175.0175.0412.0273.0659.0273.4142 0 .75.3358.75.75s-.3358.75-.75.75c-.4225 0-.8278-.1678-1.1265-.4666-.2988-.2988-.4666-.704-.4666-1.1265v-4.2156c0-.0247-.0098-.0484-.0273-.0659-.0175-.0174-.0412-.0273-.0659-.0273-.4142 0-.75-.3357-.75-.75z",fill:"currentColor",fillRule:"evenodd"})}))},78895:(e,a,n)=>{"use strict";n.d(a,{A:()=>_});var i=n(6029),t=n(55729),r=n(43501),l=n(67502),o=n(66331),s=n(55133),d=n(3113),c=n(11340),m=n(45638),u=n(124),f=n(89719),v=n(68968),p=n(46751),h=n(26046);let b=({onCancel:e,onSubmit:a,submitLabel:n="Add user"})=>{let{t}=(0,p.c3)(),{register:r,handleSubmit:l,formState:b}=(0,h.mN)(),{errors:k,isSubmitting:x,isSubmitSuccessful:g}=b,{company:y}=(0,v.P0)(),w=(0,u.C)(y.idx);async function N({name:e,email:n}){let i=await w({variables:{name:e,email:n}}),t=i?.data?.companyFollowerCreate;if(!t)throw Error(`Failed to add ${e}`);a(t)}return(0,i.jsxs)(m.A,{as:"form",stack:!0,gap:8,onSubmit:l(N),name:"create-follower",children:[(0,i.jsxs)(m.A,{stack:!0,gap:5,children:[k.submission&&(0,i.jsx)(o.A,{variant:"error",children:k.submission.message}),(0,i.jsx)(c.A,{...r("name",{required:!0}),placeholder:t("form-label-name"),label:t("form-label-name"),error:k.name,size:"lg"}),(0,i.jsx)(c.A,{...r("email",{validate:{isEmail:f.xf}}),placeholder:t("form-label-email"),label:t("form-label-email"),type:"email",error:k.email,size:"lg"}),(0,i.jsx)(d.A,{...r("confirm",{required:!0}),label:"I have permission to add this person's details",labelVariant:{size:.875,weight:"normal",color:"text-medium"},labelPosition:"right"})]}),(0,i.jsxs)(m.A,{gap:3,className:"justify-center",children:[(0,i.jsx)(s.Ay,{disabled:x||g,variant:"secondary-ghost",size:"lg",onClick:()=>e(),children:"Cancel"}),(0,i.jsx)(s.Ay,{type:"submit",disabled:x||g,loading:x,variant:"frill",size:"lg",children:n})]})]})};var k=n(3538),x=n(43328);let g=({onSubmit:e,onCancel:a,submitLabel:n})=>(0,i.jsx)(k.Ay,{close:a,children:(0,i.jsxs)(m.A,{stack:!0,gap:5,className:"w-full",children:[(0,i.jsx)(x.Ay,{as:"h3",size:1.5,weight:"semibold",tracking:"heading",className:"text-center",children:"Add a new user"}),(0,i.jsx)(b,{onSubmit:e,onCancel:a,submitLabel:n})]})});var y=n(19556),w=n(942),N=n(47995),C=n(96927),S=n(10224),j=n(77807),A=n(22295),F=n(70808),z=n(29481),E=n(94511),V=n(94722),D=n(14740);let _=({createLabel:e,defaultValue:a,name:n="follower",onChange:o,showCreateUser:s,size:d,variant:u})=>{let{t:f}=(0,p.c3)(),{perms:h}=(0,v.P0)(),b=(0,j.b)(),[k,_]=t.useState(a?.name),[$,P]=t.useState(!1),[R,q]=t.useState(a),O=t.useRef(null),T=t.useRef(null),L=(0,E.Y)(_,{wait:600}),Q=(0,F.C)(a=>(0,i.jsx)(g,{onSubmit:a,onCancel:a,submitLabel:e}));(0,S.N)({skip:!(a?.idx&&!a?.name),variables:{user_idx:a?.idx},onCompleted(e){if(e?.companyFollower){let{idx:a,name:n,avatar:i}=e.companyFollower;q({idx:a,name:n,avatar:i});return}let{idx:a,name:n,avatar:i}=b;q({idx:a,name:n,avatar:i})},onError(){let{idx:e,name:a,avatar:n}=b;q({idx:e,name:a,avatar:n})}});let B=(0,z.y)(T),G=(0,V.V)();function I(){P(!0)}function J(e){o(e),q(e),P(!e),_("")}async function M(){if(!h.users)return;let e=await Q();e&&J(e)}return t.useEffect(()=>{function e(){P(!1)}if($){B.add(e,{stopPropagation:!0}),G.add(e,{stopPropagation:!0});return}B.remove(),G.remove()},[$]),(0,D.N)(()=>{$&&O.current&&(O.current.focus(),O.current.select())},[$]),(0,i.jsxs)("div",{ref:T,className:"relative z-2",children:[R&&!$?(0,i.jsxs)("div",{className:"relative z-2",children:[(0,i.jsxs)(m.A,{as:"button",type:"button",gap:3,className:(0,A.cn)("items-center",(0,w.J2)(d,u),"cursor-text"),onClick:I,children:[(0,i.jsx)("div",{className:"-my-1",children:(0,i.jsx)(r.Ay,{name:R.name,image:R.avatar})}),(0,i.jsx)(x.Ay,{size:"inherit",color:"current",children:R.name||(0,i.jsx)(i.Fragment,{children:"\xa0"})})]}),(0,i.jsx)(C.A,{onClick:I,onMouseDown:e=>e.preventDefault(),variant:"highlight",weight:"semibold",size:.75,className:"absolute top-1/2 right-4 -translate-y-1/2",children:"Change"})]}):(0,i.jsx)(c.A,{placeholder:f("search-users-placeholder"),name:n,onChange:function(e){let{value:a}=e.target;(!a||a.length>=3)&&(L(a),P(!0))},defaultValue:k,className:"w-full",autoComplete:"off",size:d,variant:u,onClick:I,onFocus:I,ref:O}),(0,i.jsxs)(y.A,{as:"div",in:$,mountOnEnter:!0,unmountOnExit:!0,duration:200,translateClassName:"-translate-y-1",className:"absolute top-full mt-2 w-full z-popover backface-hidden max-h-none flex-col bg-shade-0 border border-shade-20 rounded-md shadow-popover",children:[(0,i.jsx)(l.A,{onSelect:J,search:k,selected:R?[R.idx]:void 0,targetRef:T}),s&&h.users&&(0,i.jsxs)("button",{type:"button",className:"px-5 py-4 flex w-full text-left leading-none text-0.8125 font-normal text-text-medium hover:text-text border-t border-shade-20 transition-colors font-medium",onClick:M,children:[(0,i.jsx)(N.A,{size:"0.75rem",className:"mr-1"}),(0,i.jsx)("span",{children:"Add a new user"})]})]})]})}}}]);